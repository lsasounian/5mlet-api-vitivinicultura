import logging
from pymongo import MongoClient

# Configuração do logger
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

# Configuração do MongoDB
MONGO_URI = "mongodb://localhost:27017"
DATABASE_NAME = "vitivinicultura"
COLLECTION_NAME = "abc_exportacao"

# Função para persistir os dados
def salvar(dados: str):
    try:
        logger.info("Iniciando a persistência dos Dados.")
        client = MongoClient(MONGO_URI)
        db = client[DATABASE_NAME]
        collection = db[COLLECTION_NAME]
        collection.insert_one(abc_data)  # Insere os dados
        logger.info("Dados persistidos com sucesso.")
    except Exception as e:
        logger.error(f"Erro ao persistir dados : {e}")